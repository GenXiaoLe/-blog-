<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Linux基础命令使用 | 小乐的技术分享</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="前端知识记录分享">
    
    <link rel="preload" href="/assets/css/0.styles.078297f0.css" as="style"><link rel="preload" href="/assets/js/app.bebcfdff.js" as="script"><link rel="preload" href="/assets/js/2.3a20e52e.js" as="script"><link rel="preload" href="/assets/js/13.98915912.js" as="script"><link rel="prefetch" href="/assets/js/10.e65083b4.js"><link rel="prefetch" href="/assets/js/11.e280eccd.js"><link rel="prefetch" href="/assets/js/12.4fef2989.js"><link rel="prefetch" href="/assets/js/3.6aeb180a.js"><link rel="prefetch" href="/assets/js/4.78a1326e.js"><link rel="prefetch" href="/assets/js/5.ab5d39e7.js"><link rel="prefetch" href="/assets/js/6.11849f16.js"><link rel="prefetch" href="/assets/js/7.242ff817.js"><link rel="prefetch" href="/assets/js/8.0b696a36.js"><link rel="prefetch" href="/assets/js/9.a7ca9f6a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.078297f0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">小乐的技术分享</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="https://segmentfault.com/u/yagenl" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Segmentfault主页
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/GenXiaoLe" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="https://segmentfault.com/u/yagenl" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Segmentfault主页
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/GenXiaoLe" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/nodeBasis/" class="sidebar-link">node基础</a></li><li><a href="/vue2Basis/" class="sidebar-link">vue2基础</a></li><li><a href="/project/" class="sidebar-link">项目应用</a></li><li><a href="/webProject/" aria-current="page" class="active sidebar-link">服务端部署</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/webProject/#linux基础命令使用" class="sidebar-link">Linux基础命令使用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/webProject/#ssh" class="sidebar-link">SSH</a></li><li class="sidebar-sub-header"><a href="/webProject/#uname" class="sidebar-link">uname</a></li><li class="sidebar-sub-header"><a href="/webProject/#ls" class="sidebar-link">ls</a></li><li class="sidebar-sub-header"><a href="/webProject/#cd" class="sidebar-link">cd</a></li><li class="sidebar-sub-header"><a href="/webProject/#mkdir" class="sidebar-link">mkdir</a></li><li class="sidebar-sub-header"><a href="/webProject/#vim" class="sidebar-link">vim</a></li><li class="sidebar-sub-header"><a href="/webProject/#sudo" class="sidebar-link">sudo</a></li><li class="sidebar-sub-header"><a href="/webProject/#scp-重点" class="sidebar-link">scp(重点)</a></li><li class="sidebar-sub-header"><a href="/webProject/#rm" class="sidebar-link">rm</a></li></ul></li><li class="sidebar-sub-header"><a href="/webProject/#pm2" class="sidebar-link">Pm2</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/webProject/#pm2安装-全局" class="sidebar-link">pm2安装（全局）</a></li><li class="sidebar-sub-header"><a href="/webProject/#启动服务" class="sidebar-link">启动服务</a></li><li class="sidebar-sub-header"><a href="/webProject/#监听服务" class="sidebar-link">监听服务</a></li><li class="sidebar-sub-header"><a href="/webProject/#查看启动列表" class="sidebar-link">查看启动列表</a></li><li class="sidebar-sub-header"><a href="/webProject/#日志查看" class="sidebar-link">日志查看</a></li><li class="sidebar-sub-header"><a href="/webProject/#停止服务" class="sidebar-link">停止服务</a></li><li class="sidebar-sub-header"><a href="/webProject/#重启应用" class="sidebar-link">重启应用</a></li></ul></li><li class="sidebar-sub-header"><a href="/webProject/#nginx" class="sidebar-link">Nginx</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/webProject/#安装依赖" class="sidebar-link">安装依赖</a></li><li class="sidebar-sub-header"><a href="/webProject/#下载" class="sidebar-link">下载</a></li><li class="sidebar-sub-header"><a href="/webProject/#解压" class="sidebar-link">解压</a></li><li class="sidebar-sub-header"><a href="/webProject/#使用默认配置" class="sidebar-link">使用默认配置</a></li><li class="sidebar-sub-header"><a href="/webProject/#编译安装" class="sidebar-link">编译安装</a></li><li class="sidebar-sub-header"><a href="/webProject/#找到nginx路径" class="sidebar-link">找到nginx路径</a></li><li class="sidebar-sub-header"><a href="/webProject/#启动" class="sidebar-link">启动</a></li><li class="sidebar-sub-header"><a href="/webProject/#重启nginx" class="sidebar-link">重启nginx</a></li></ul></li><li class="sidebar-sub-header"><a href="/webProject/#服务端部署前端服务" class="sidebar-link">服务端部署前端服务</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/webProject/#本地文件上传至服务器" class="sidebar-link">本地文件上传至服务器</a></li><li class="sidebar-sub-header"><a href="/webProject/#打开配置文件" class="sidebar-link">打开配置文件</a></li><li class="sidebar-sub-header"><a href="/webProject/#进行文件配置" class="sidebar-link">进行文件配置</a></li><li class="sidebar-sub-header"><a href="/webProject/#重启" class="sidebar-link">重启</a></li></ul></li><li class="sidebar-sub-header"><a href="/webProject/#服务端部署node服务" class="sidebar-link">服务端部署node服务</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/webProject/#本地文件上传至服务器-2" class="sidebar-link">本地文件上传至服务器</a></li><li class="sidebar-sub-header"><a href="/webProject/#监听node服务" class="sidebar-link">监听node服务</a></li><li class="sidebar-sub-header"><a href="/webProject/#nginx反向代理node服务" class="sidebar-link">Nginx反向代理node服务</a></li></ul></li><li class="sidebar-sub-header"><a href="/webProject/#docker使用" class="sidebar-link">Docker使用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/webProject/#安装docker" class="sidebar-link">安装docker</a></li><li class="sidebar-sub-header"><a href="/webProject/#上手使用" class="sidebar-link">上手使用</a></li></ul></li><li class="sidebar-sub-header"><a href="/webProject/#jenkins使用" class="sidebar-link">Jenkins使用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/webProject/#安装java8" class="sidebar-link">安装java8</a></li><li class="sidebar-sub-header"><a href="/webProject/#安装镜像jenkins" class="sidebar-link">安装镜像jenkins</a></li><li class="sidebar-sub-header"><a href="/webProject/#启动jenkins容器" class="sidebar-link">启动jenkins容器</a></li><li class="sidebar-sub-header"><a href="/webProject/#查看容器的运行状态" class="sidebar-link">查看容器的运行状态</a></li><li class="sidebar-sub-header"><a href="/webProject/#jenkins的关闭-重新启动" class="sidebar-link">jenkins的关闭&amp;重新启动</a></li><li class="sidebar-sub-header"><a href="/webProject/#初始化配置jenkins" class="sidebar-link">初始化配置jenkins</a></li><li class="sidebar-sub-header"><a href="/webProject/#jenkins构建部署至服务器" class="sidebar-link">jenkins构建部署至服务器</a></li></ul></li></ul></li><li><a href="/algorithm/" class="sidebar-link">前端算法</a></li><li><a href="/article/" class="sidebar-link">个人拓展文章</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="linux基础命令使用"><a href="#linux基础命令使用" class="header-anchor">#</a> Linux基础命令使用</h2> <p>在服务其使用之前，我们需要了解一下Linux的基础使用，才能愉快地玩耍</p> <h3 id="ssh"><a href="#ssh" class="header-anchor">#</a> SSH</h3> <p>有了服务器，如何在本地登录登陆是一个开始</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">ssh</span> root@服务器ip
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>每次都输入密码很是繁琐，所以我们可以配置本地免密登陆</p></div> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 生成rsa秘钥，一路回车（已有rsa秘钥的请跳过此步骤）</span>
ssh-keygen -t rsa

<span class="token comment"># 找到刚才生成的秘钥</span>
<span class="token function">cat</span> ~/.ssh/id_rsa.pub
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAA---------中间部分生路--------ji4lr xiaofengge@xiaofengge.local

<span class="token comment"># 登录云服务器，找到秘钥文件，将本地秘钥拷贝到云服务器即可</span>
<span class="token function">vim</span> ~/.ssh/authorized_keys

<span class="token comment"># 再次登录云服务器，会发现不用输入密码</span>
<span class="token function">ssh</span> root@服务器ip

<span class="token comment"># 配置别名</span>
<span class="token function">vim</span> ~/.ssh/config

$  Host <span class="token number">126</span> <span class="token comment"># 126就是别名，我们可以用ssh 126 登录我们的服务器</span>
$  User root <span class="token comment"># 用户名</span>
$  Port <span class="token number">22</span> <span class="token comment"># 端口号</span>
$  HostName <span class="token number">47.116</span>.27.64 <span class="token comment"># 云服务器IP</span>
$  IdentityFile ~/.ssh/id_rsa <span class="token comment"># 秘钥位置</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p><strong>参数</strong></p> <table><thead><tr><th>参数</th> <th style="text-align:center;">含义</th></tr></thead> <tbody><tr><td>ssh</td> <td style="text-align:center;">登陆的协议</td></tr> <tr><td>root</td> <td style="text-align:center;">用户名</td></tr> <tr><td>服务器ip</td> <td style="text-align:center;">服务器的地址</td></tr></tbody></table> <h3 id="uname"><a href="#uname" class="header-anchor">#</a> uname</h3> <p>可显示电脑以及操作系统的相关信息</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">uname</span> <span class="token punctuation">[</span>-amnrsv<span class="token punctuation">]</span><span class="token punctuation">[</span>--help<span class="token punctuation">]</span><span class="token punctuation">[</span>--version<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>参数</strong></p> <table><thead><tr><th>参数</th> <th style="text-align:center;">含义</th></tr></thead> <tbody><tr><td>-a或--all</td> <td style="text-align:center;">显示全部的信息。</td></tr> <tr><td>-m或--machine</td> <td style="text-align:center;">显示电脑类型。</td></tr> <tr><td>-n或-nodename</td> <td style="text-align:center;">显示在网络上的主机名称。</td></tr> <tr><td>-r或--release</td> <td style="text-align:center;">显示操作系统的发行编号。</td></tr> <tr><td>-s或--sysname</td> <td style="text-align:center;">显示操作系统名称。</td></tr> <tr><td>-v</td> <td style="text-align:center;">显示操作系统的版本。</td></tr> <tr><td>--help</td> <td style="text-align:center;">显示帮助。</td></tr> <tr><td>--version</td> <td style="text-align:center;">显示版本信息。</td></tr></tbody></table> <h3 id="ls"><a href="#ls" class="header-anchor">#</a> ls</h3> <p>查看当前目录下包含的内容</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">ls</span> <span class="token punctuation">[</span>-alrtAFR<span class="token punctuation">]</span> <span class="token punctuation">[</span>name<span class="token punctuation">..</span>.<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>参数</strong></p> <table><thead><tr><th>参数</th> <th style="text-align:center;">含义</th></tr></thead> <tbody><tr><td>-a</td> <td style="text-align:center;">显示所有文件及目录 (ls内定将文件名或目录名称开头为&quot;.&quot;的视为隐藏档，不会列出)</td></tr> <tr><td>-l</td> <td style="text-align:center;">除文件名称外，亦将文件型态、权限、拥有者、文件大小等资讯详细列出</td></tr> <tr><td>-r</td> <td style="text-align:center;">显示在网络上的主机名称。</td></tr></tbody></table> <h3 id="cd"><a href="#cd" class="header-anchor">#</a> cd</h3> <p>跳入其他的目录</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token builtin class-name">cd</span> <span class="token punctuation">[</span>dirName<span class="token punctuation">]</span>

<span class="token comment"># 返回上层目录</span>
<span class="token builtin class-name">cd</span> <span class="token punctuation">..</span>

<span class="token comment"># 返回根目录</span>
<span class="token builtin class-name">cd</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>参数</strong></p> <table><thead><tr><th>参数</th> <th style="text-align:center;">含义</th></tr></thead> <tbody><tr><td>dirName</td> <td style="text-align:center;">要切换的目标目录</td></tr></tbody></table> <h3 id="mkdir"><a href="#mkdir" class="header-anchor">#</a> mkdir</h3> <p>用于建立名称为 dirName 之子目录</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">mkdir</span> <span class="token punctuation">[</span>-p<span class="token punctuation">]</span> dirName
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>参数</strong></p> <table><thead><tr><th>参数</th> <th style="text-align:center;">含义</th></tr></thead> <tbody><tr><td>dirName</td> <td style="text-align:center;">创建的目录名</td></tr> <tr><td>-p</td> <td style="text-align:center;">确保目录名称存在，不存在的就建一个</td></tr></tbody></table> <h3 id="vim"><a href="#vim" class="header-anchor">#</a> vim</h3> <p>使用vim打开或创建一个文档</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">vim</span> path
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>参数</strong></p> <table><thead><tr><th>参数</th> <th style="text-align:center;">含义</th></tr></thead> <tbody><tr><td>path</td> <td style="text-align:center;">文件路径</td></tr></tbody></table> <h3 id="sudo"><a href="#sudo" class="header-anchor">#</a> sudo</h3> <p>以系统管理者的身份执行指令，也就是说，经由 sudo 所执行的指令就好像是 root 亲自执行</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token variable">$shell</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>参数</strong></p> <table><thead><tr><th>参数</th> <th style="text-align:center;">含义</th></tr></thead> <tbody><tr><td>$shell</td> <td style="text-align:center;">执行的命令</td></tr></tbody></table> <h3 id="scp-重点"><a href="#scp-重点" class="header-anchor">#</a> scp(重点)</h3> <p><strong>什么是scp</strong></p> <ul><li>secure copy</li> <li>用于在Linux下进行远程拷贝文件，scp传输是加密的</li> <li>需要输入密码</li></ul> <p><strong>什么是scp</strong></p> <ul><li>远程服务器既不需要配置ftp服务器</li> <li>不需要开启web服务器</li> <li>也不需要开启共享</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 上传文件到远程服务器</span>
<span class="token function">scp</span> -r 本地需要上传的文件的路径 root@服务器ip:服务器文件路径

<span class="token comment"># 下载远程服务器文件到本地</span>
<span class="token function">scp</span> -r root@服务器ip:服务器文件路径 本地文件路径
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>scp上传文件到服务器是在我们本地电脑运行命令，不是登录服务器</p></div> <h3 id="rm"><a href="#rm" class="header-anchor">#</a> rm</h3> <p>删除目录或者文件</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>
<span class="token comment"># 删除文件</span>
<span class="token function">rm</span> -f path

<span class="token comment"># 删除文件夹</span>
<span class="token function">rm</span> -rf path

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>参数</strong></p> <table><thead><tr><th>参数</th> <th style="text-align:center;">含义</th></tr></thead> <tbody><tr><td>path</td> <td style="text-align:center;">文件路径</td></tr></tbody></table> <h2 id="pm2"><a href="#pm2" class="header-anchor">#</a> Pm2</h2> <ul><li><p>日志管理：应用程序日志保存在服务器的硬盘中~/.pm2/logs/</p></li> <li><p>负载均衡：PM2可以通过创建共享同一服务器端口的多个子进程来扩展您的应用程序。这样做还允许您以零秒停机时间重新启动应用程序。</p></li> <li><p>终端监控：可以在终端中监控您的应用程序并检查应用程序运行状况（CPU使用率，使用的内存，请求/分钟等）。</p></li> <li><p>SSH部署：自动部署，避免逐个在所有服务器中进行ssh。</p></li> <li><p>静态服务：支持静态服务器功能</p></li> <li><p>多平台支持：适用于Linux（稳定）和macOS（稳定）和Windows（稳定）</p></li></ul> <h3 id="pm2安装-全局"><a href="#pm2安装-全局" class="header-anchor">#</a> pm2安装（全局）</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># npm安装</span>
<span class="token function">npm</span> <span class="token function">install</span> pm2 -g
<span class="token comment"># mac 系统：添加sudo</span>

<span class="token comment"># yarn安装</span>
<span class="token function">yarn</span> global <span class="token function">add</span> pm2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="启动服务"><a href="#启动服务" class="header-anchor">#</a> 启动服务</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>pm2 start app.js                <span class="token comment"># 启动app.js应用</span>
pm2 start app.js --name demo    <span class="token comment"># 启动应用并设置name</span>
pm2 start app.sh                <span class="token comment"># 脚本启动</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="监听服务"><a href="#监听服务" class="header-anchor">#</a> 监听服务</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>pm2 start app.js --watch    <span class="token comment"># 当文件发生变化，自动重启</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="查看启动列表"><a href="#查看启动列表" class="header-anchor">#</a> 查看启动列表</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>pm2 list
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="日志查看"><a href="#日志查看" class="header-anchor">#</a> 日志查看</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>pm2 logs            <span class="token comment"># 查看所有应用日志</span>
pm2 logs <span class="token punctuation">[</span>Name<span class="token punctuation">]</span>     <span class="token comment"># 根据指定应用名查看应用日志</span>
pm2 logs <span class="token punctuation">[</span>ID<span class="token punctuation">]</span>       <span class="token comment"># 根据指定应用ID查看应用日志</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="停止服务"><a href="#停止服务" class="header-anchor">#</a> 停止服务</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>pm2 stop all               <span class="token comment"># 停止所有应用</span>
pm2 stop <span class="token punctuation">[</span>AppName<span class="token punctuation">]</span>         <span class="token comment"># 根据应用名停止指定应用</span>
pm2 stop <span class="token punctuation">[</span>ID<span class="token punctuation">]</span>              <span class="token comment"># 根据应用id停止指定应用</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="重启应用"><a href="#重启应用" class="header-anchor">#</a> 重启应用</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>pm2 restart app.js        <span class="token comment"># 重启app.js进程</span>
pm2 restart all           <span class="token comment"># 重启所有进程</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="nginx"><a href="#nginx" class="header-anchor">#</a> Nginx</h2> <p>nginx (engine x) 是一个高性能的HTTP和反向代理服务，也是一个IMAP/POP3/SMTP服务</p> <h3 id="安装依赖"><a href="#安装依赖" class="header-anchor">#</a> 安装依赖</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>yum -y <span class="token function">install</span> gcc-c++  
yum -y <span class="token function">install</span> pcre pcre-devel  
yum -y <span class="token function">install</span> zlib zlib-devel  
yum -y <span class="token function">install</span> openssl openssl--devel
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="下载"><a href="#下载" class="header-anchor">#</a> 下载</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">wget</span> -c https://nginx.org/download/nginx-1.14.0.tar.gz
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="解压"><a href="#解压" class="header-anchor">#</a> 解压</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">tar</span> -zxvf nginx-1.14.0.tar.gz
<span class="token builtin class-name">cd</span> nginx-1.14.0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="使用默认配置"><a href="#使用默认配置" class="header-anchor">#</a> 使用默认配置</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>./configure
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="编译安装"><a href="#编译安装" class="header-anchor">#</a> 编译安装</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">make</span>
<span class="token function">make</span> <span class="token function">install</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="找到nginx路径"><a href="#找到nginx路径" class="header-anchor">#</a> 找到nginx路径</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">whereis</span> nginx
<span class="token comment"># /usr/local/nginx</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="启动"><a href="#启动" class="header-anchor">#</a> 启动</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token builtin class-name">cd</span> /usr/local/nginx/sbin/
./nginx :启动
./nginx -s stop <span class="token comment"># 此方式相当于先查出nginx进程id再使用kill命令强制杀掉进程</span>
./nginx -s quit <span class="token comment"># 此方式停止步骤是待nginx进程处理任务完毕进行停止。</span>
./nginx -s reloa <span class="token comment"># 重启</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="重启nginx"><a href="#重启nginx" class="header-anchor">#</a> 重启nginx</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token builtin class-name">cd</span> /usr/local/nginx/sbin/
./nginx -s quit
./nginx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>此时，nginx安装启动完毕，我们可以通过服务器IP访问我们的网站了！！！
需要注意的一点是，nginx默认部署在80端口，服务器一定要注意开放80端口</p></div> <h2 id="服务端部署前端服务"><a href="#服务端部署前端服务" class="header-anchor">#</a> 服务端部署前端服务</h2> <p>上面我们已经学到了linux的基本使用和Nginx的安装配置，下面我们开始部署自己的前端服务。首先我们以CentOS7+服务器为例，先看一下默认网站目录</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 这个html目录就是默认nginx网站存放目录</span>
/usr/local/nginx/html
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="本地文件上传至服务器"><a href="#本地文件上传至服务器" class="header-anchor">#</a> 本地文件上传至服务器</h3> <p>首先我们需要把我们的前端项目进行build构建，我们需要把构建后的dist文件部署到服务器指定位置上</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 本地shell</span>
<span class="token function">scp</span> -r xxx/xxx/xxx/dist root@服务器ip: /usr/local/nginx/html
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>scp上传文件到服务器是在我们本地电脑运行命令，不是登录服务器!!!</p></div> <h3 id="打开配置文件"><a href="#打开配置文件" class="header-anchor">#</a> 打开配置文件</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">vim</span> /usr/local/nginx/conf/nginx.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>文件内参数</p> <table><thead><tr><th>参数</th> <th style="text-align:center;">含义</th></tr></thead> <tbody><tr><td>main</td> <td style="text-align:center;">用于进行nginx全局信息的配置</td></tr> <tr><td>events</td> <td style="text-align:center;">用于nginx工作模式的配置</td></tr> <tr><td>http</td> <td style="text-align:center;">用于进行http协议信息的一些配置</td></tr> <tr><td>http-&gt;server</td> <td style="text-align:center;">用于进行服务器访问信息的配置</td></tr> <tr><td>http-&gt;location</td> <td style="text-align:center;">用于进行访问路由的配置</td></tr> <tr><td>upstream</td> <td style="text-align:center;">用于进行负载均衡的配置</td></tr></tbody></table> <h3 id="进行文件配置"><a href="#进行文件配置" class="header-anchor">#</a> 进行文件配置</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 这里我时候用的是root用户，正常情况下是不可取的</span>
<span class="token comment"># 配置用户或者组，默认为nobody nobody</span>
user  root<span class="token punctuation">;</span>

<span class="token comment"># 允许许生成的进程数，默认为1</span>
worker_processes  <span class="token number">2</span><span class="token punctuation">;</span>

<span class="token comment"># 制定日志路径，级别</span>
<span class="token comment">#error_log  logs/error.log;</span>
<span class="token comment">#error_log  logs/error.log  notice;</span>
<span class="token comment">#error_log  logs/error.log  info;</span>

<span class="token comment"># 指定nginx进程运行文件存放地址</span>
<span class="token comment">#pid        logs/nginx.pid;</span>


events <span class="token punctuation">{</span>
    <span class="token comment"># 最大连接数，默认为512</span>
    worker_connections  <span class="token number">1024</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


http <span class="token punctuation">{</span>
    <span class="token comment"># 文件扩展名与文件类型映射表</span>
    include       mime.types<span class="token punctuation">;</span>
    <span class="token comment"># 默认文件类型，默认为text/plain</span>
    default_type  application/octet-stream<span class="token punctuation">;</span>

    <span class="token comment"># 日志服务的设置</span>
    <span class="token comment">#log_format  main  '$remote_addr - $remote_user [$time_local] &quot;$request&quot; '</span>
    <span class="token comment">#                  '$status $body_bytes_sent &quot;$http_referer&quot; '</span>
    <span class="token comment">#                  '&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;';</span>

    <span class="token comment">#access_log  logs/access.log  main;</span>

    <span class="token comment"># 允许sendfile方式传输文件，默认为off</span>
    sendfile        on<span class="token punctuation">;</span>
    <span class="token comment"># 让nginx在一个数据包中发送所有的头文件，而不是一个一个单独发</span>
    <span class="token comment">#tcp_nopush     on;</span>

    <span class="token comment"># 连接超时时间</span>
    keepalive_timeout  <span class="token number">65</span><span class="token punctuation">;</span>
    <span class="token comment"># 开启gzip压缩</span>
    <span class="token function">gzip</span>  on<span class="token punctuation">;</span>

    <span class="token comment"># 服务1</span>
    server <span class="token punctuation">{</span>
        <span class="token comment"># 监听的端口</span>
        listen       <span class="token number">80</span><span class="token punctuation">;</span>
        <span class="token comment"># 用于配置路由访问信息</span>
        location / <span class="token punctuation">{</span>
           <span class="token comment"># 指定ip地址或者域名，多个配置之间用空格分隔</span>
           server_name  xxx.xxx.com<span class="token punctuation">;</span>
           <span class="token comment"># 网站存储地址</span>
           root html/dist<span class="token punctuation">;</span>
           <span class="token comment"># 用户访问web网站时的全局首页</span>
           index index.html index.htm<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br></div></div><h3 id="重启"><a href="#重启" class="header-anchor">#</a> 重启</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token builtin class-name">cd</span> /usr/local/nginx/sbin/
./nginx -s reload
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="服务端部署node服务"><a href="#服务端部署node服务" class="header-anchor">#</a> 服务端部署node服务</h2> <p>这里我们主要实战一下pm2+nginx反向代理，部署后端服务</p> <h3 id="本地文件上传至服务器-2"><a href="#本地文件上传至服务器-2" class="header-anchor">#</a> 本地文件上传至服务器</h3> <p>首先我们需要把我们的前端项目进行build构建，我们需要把构建后的dist文件部署到服务器指定位置上</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 本地shell</span>
<span class="token function">scp</span> -r /xxx/serve root@服务器ip: /usr/local/nginx/html
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>scp上传文件到服务器是在我们本地电脑运行命令，不是登录服务器!!!</p></div> <h3 id="监听node服务"><a href="#监听node服务" class="header-anchor">#</a> 监听node服务</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>pm2 start xxx/serve/app.js --watch    <span class="token comment"># 当文件发生变化，自动重启</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>app.js就是我们写的接口，记得在服务器上开启启动的相应端口</p></div> <h3 id="nginx反向代理node服务"><a href="#nginx反向代理node服务" class="header-anchor">#</a> Nginx反向代理node服务</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 这里我时候用的是root用户，正常情况下是不可取的</span>
<span class="token comment"># 配置用户或者组，默认为nobody nobody</span>
user  root<span class="token punctuation">;</span>

<span class="token comment"># 允许许生成的进程数，默认为1</span>
worker_processes  <span class="token number">2</span><span class="token punctuation">;</span>

<span class="token comment"># 制定日志路径，级别</span>
<span class="token comment">#error_log  logs/error.log;</span>
<span class="token comment">#error_log  logs/error.log  notice;</span>
<span class="token comment">#error_log  logs/error.log  info;</span>

<span class="token comment"># 指定nginx进程运行文件存放地址</span>
<span class="token comment">#pid        logs/nginx.pid;</span>


events <span class="token punctuation">{</span>
    <span class="token comment"># 最大连接数，默认为512</span>
    worker_connections  <span class="token number">1024</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


http <span class="token punctuation">{</span>
    <span class="token comment"># 文件扩展名与文件类型映射表</span>
    include       mime.types<span class="token punctuation">;</span>
    <span class="token comment"># 默认文件类型，默认为text/plain</span>
    default_type  application/octet-stream<span class="token punctuation">;</span>

    <span class="token comment"># 日志服务的设置</span>
    <span class="token comment">#log_format  main  '$remote_addr - $remote_user [$time_local] &quot;$request&quot; '</span>
    <span class="token comment">#                  '$status $body_bytes_sent &quot;$http_referer&quot; '</span>
    <span class="token comment">#                  '&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;';</span>

    <span class="token comment">#access_log  logs/access.log  main;</span>

    <span class="token comment"># 允许sendfile方式传输文件，默认为off</span>
    sendfile        on<span class="token punctuation">;</span>
    <span class="token comment"># 让nginx在一个数据包中发送所有的头文件，而不是一个一个单独发</span>
    <span class="token comment">#tcp_nopush     on;</span>

    <span class="token comment"># 连接超时时间</span>
    keepalive_timeout  <span class="token number">65</span><span class="token punctuation">;</span>
    <span class="token comment"># 开启gzip压缩</span>
    <span class="token function">gzip</span>  on<span class="token punctuation">;</span>

    <span class="token comment"># 服务1</span>
    server <span class="token punctuation">{</span>
        <span class="token comment"># 监听的端口</span>
        listen       <span class="token number">80</span><span class="token punctuation">;</span>
        <span class="token comment"># 用于配置路由访问信息</span>
        location / <span class="token punctuation">{</span>
           <span class="token comment"># 指定ip地址或者域名，多个配置之间用空格分隔</span>
           server_name  xxx.xxx.com<span class="token punctuation">;</span>
           <span class="token comment"># 网站存储地址</span>
           root html/dist<span class="token punctuation">;</span>
           <span class="token comment"># 用户访问web网站时的全局首页</span>
           index index.html index.htm<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment"># 将/api/反向代理至当前端口</span>
        location /api/ <span class="token punctuation">{</span>
           <span class="token comment"># 代理到的服务器端口</span>
           proxy_pass http://xxx.xxx.xx:8080/<span class="token punctuation">;</span>
           proxy_redirect off<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>serve的js启动服务器的服务端口，就是nginx需要配置的反向代理端口，在前端请求时只需要使用/api/xxxx就可以进行代理请求，实现跨域。vue-cli中的proxy也是这个原理</p></div> <h2 id="docker使用"><a href="#docker使用" class="header-anchor">#</a> Docker使用</h2> <p>Docker是一款以容器虚拟化技术为基础的软件。为程序跨平台兼容而生，将虚拟化应用于资源管理，是一个由 Go 语言实现的容器引擎。</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Docker是围绕镜像 ( Image )、容器 ( Container )、网络 ( Network )、数据卷 ( Volume )所展开。我们所有的操作均以CentOS操作系统为例</p></div> <h3 id="安装docker"><a href="#安装docker" class="header-anchor">#</a> 安装docker</h3> <p>首先进行 Docker 的安装</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ <span class="token function">sudo</span> yum <span class="token function">install</span> yum-utils device-mapper-persistent-data lvm2
$
$ <span class="token function">sudo</span> yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo
$ <span class="token function">sudo</span> yum <span class="token function">install</span> docker-ce
$
$ <span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> docker
$ <span class="token function">sudo</span> systemctl start docker
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="上手使用"><a href="#上手使用" class="header-anchor">#</a> 上手使用</h3> <p>在安装 Docker 完成之后，我们需要先启动 docker daemon 使其能够为我们提供 Docker 服务，这样我们才能正常使用 Docker。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ <span class="token function">sudo</span> systemctl start docker
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><strong>docker version</strong></li></ul> <p>在 Docker 服务启动之后，我们先来尝试一个最简单的查看 Docker 版本的命令：<strong>docker version</strong>。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ <span class="token function">sudo</span> docker version
Client:
 Version:           <span class="token number">18.06</span>.1-ce
 API version:       <span class="token number">1.38</span>
 Go version:        go1.10.3
 Git commit:        e68fc7a
 Built:             Tue Aug <span class="token number">21</span> <span class="token number">17</span>:23:03 <span class="token number">2018</span>
 OS/Arch:           linux/amd64
 Experimental:      <span class="token boolean">false</span>

Server:
 Engine:
  Version:          <span class="token number">18.06</span>.1-ce
  API version:      <span class="token number">1.38</span> <span class="token punctuation">(</span>minimum version <span class="token number">1.12</span><span class="token punctuation">)</span>
  Go version:       go1.10.3
  Git commit:       e68fc7a
  Built:            Tue Aug <span class="token number">21</span> <span class="token number">17</span>:25:29 <span class="token number">2018</span>
  OS/Arch:          linux/amd64
  Experimental:     <span class="token boolean">false</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><ul><li><strong>docker info</strong></li></ul> <p>如果想要了解 Docker Engine 更多相关的信息，我们还可以通过 <strong>docker info</strong> 这个命令。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ <span class="token function">sudo</span> docker info
Containers: <span class="token number">0</span>
 Running: <span class="token number">0</span>
 Paused: <span class="token number">0</span>
 Stopped: <span class="token number">0</span>
Images: <span class="token number">0</span>
Server Version: <span class="token number">18.06</span>.0-ce
Storage Driver: overlay2
 Backing Filesystem: extfs
 Supports d_type: <span class="token boolean">true</span>
 Native Overlay Diff: <span class="token boolean">true</span>
Logging Driver: json-file
Cgroup Driver: cgroupfs
<span class="token comment">## ......</span>
Live Restore Enabled: <span class="token boolean">false</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><ul><li><strong>配置国内镜像源</strong></li></ul> <p>在 Linux 环境下，我们可以通过修改 /etc/docker/daemon.json ( 如果文件不存在，你可以直接创建它 ) 这个 Docker 服务的配置文件达到效果。</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>注意镜像是以https://开头</p></div> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">{</span>
    <span class="token string">&quot;registry-mirrors&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;https://registry.docker-cn.com&quot;</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>在修改之后，别忘了重新启动 docker daemon 来让配置生效哟：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>$ sudo systemctl restart docker
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>要验证我们配置的镜像源是否生效，我们可以通过 <strong>docker info</strong> 来查阅当前注册的镜像源列表。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ <span class="token function">sudo</span> docker info
<span class="token comment">## ......</span>
Registry Mirrors:
 https://registry.docker-cn.com/
<span class="token comment">## ......</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li><strong>查看镜像</strong></li></ul> <p>如果要查看当前连接的 docker daemon 中存放和管理了哪些镜像，我们可以使用 <strong>docker images</strong> 这个命令 ( Linux、macOS 还是 Windows 上都是一致的 )。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
php                 <span class="token number">7</span>-fpm               f214b5c48a25        <span class="token number">9</span> days ago          368MB
redis               <span class="token number">3.2</span>                 2fef532eadb3        <span class="token number">11</span> days ago         76MB
redis               <span class="token number">4.0</span>                 e1a73233e3be        <span class="token number">11</span> days ago         <span class="token number">83</span>.4MB
cogset/cron         latest              c01d5ac6fc8a        <span class="token number">15</span> months ago       125MB
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li><strong>获取镜像</strong></li></ul> <p>要拉取镜像，我们可以使用 <strong>docker pull</strong> 命令，命令的参数就是我们之前所提到的镜像仓库名。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ <span class="token function">sudo</span> docker pull ubuntu
Using default tag: latest
latest: Pulling from library/ubuntu
124c757242f8: Downloading <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token operator">&gt;</span>   <span class="token punctuation">]</span>  <span class="token number">30</span>.19MB/31.76MB
9d866f8bde2a: Download complete 
fa3f2f277e67: Download complete 
398d32b153e8: Download complete 
afde35469481: Download complete 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>当然，我们也能够使用完整的镜像命名来拉取镜像。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ <span class="token function">sudo</span> docker pull nginx
<span class="token number">1.13</span>.6.2-alpine: Pulling from openresty/openresty
ff3a5c916c92: Pull complete 
ede0a2a1012b: Pull complete 
0e0a11843023: Pull complete 
246b2c6f4992: Pull complete 
Digest: sha256:23ff32a1e7d5a10824ab44b24a0daf86c2df1426defe8b162d8376079a548bf2
Status: Downloaded newer image <span class="token keyword">for</span> openresty/openresty:1.13.6.2-alpine
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>Docker Hub 是 Docker 官方建立的中央镜像仓库，除了普通镜像仓库的功能外，它内部还有更加细致的权限管理，支持构建钩子和自动构建，并且有一套精致的 Web 操作页面。
Docker Hub 的地址是：hub.docker.com/。</p></div> <ul><li><strong>管理镜像</strong></li></ul> <p>如果我们要获得镜像更详细的信息，我们可以通过 <strong>docker inspect</strong> 这个命令。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ <span class="token function">sudo</span> docker inspect nginx
<span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token string">&quot;Id&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;sha256:2fef532eadb328740479f93b4a1b7595d412b9105ca8face42d3245485c39ddc&quot;</span>,
        <span class="token string">&quot;RepoTags&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
            <span class="token string">&quot;redis:3.2&quot;</span>
        <span class="token punctuation">]</span>,
        <span class="token string">&quot;RepoDigests&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
            <span class="token string">&quot;redis@sha256:745bdd82bad441a666ee4c23adb7a4c8fac4b564a1c7ac4454aa81e91057d977&quot;</span>
        <span class="token punctuation">]</span>,
<span class="token comment">## ......</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><ul><li><strong>删除镜像</strong></li></ul> <p>删除镜像的命令是 <strong>docker rmi</strong>，参数是镜像的名称或 ID。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ <span class="token function">sudo</span> docker rmi nginx
Untagged: redis:3.2
Untagged: redis@sha256:745bdd82bad441a666ee4c23adb7a4c8fac4b564a1c7ac4454aa81e91057d977
Deleted: sha256:2fef532eadb328740479f93b4a1b7595d412b9105ca8face42d3245485c39ddc
<span class="token comment">## ......</span>
Untagged: redis:4.0
Untagged: redis@sha256:b77926b30ca2f126431e4c2055efcf2891ebd4b4c4a86a53cf85ec3d4c98a4c9
Deleted: sha256:e1a73233e3beffea70442fc2cfae2c2bab0f657c3eebb3bdec1e84b6cc778b75
<span class="token comment">## ......</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ul><li><strong>创建容器</strong></li></ul> <p>当我们选择好镜像以后，就可以通过 <strong>docker create</strong> 这个命令来创建容器了。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ <span class="token function">sudo</span> docker create nginx
34f277e22be252b51d204acbb32ce21181df86520de0c337a835de6932ca06c3
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>执行 <strong>docker create</strong> 后，Docker 会根据我们所给出的镜像创建容器，在控制台中会打印出 Docker 为容器所分配的容器 ID，此时容器是处于 Created 状态的。</p> <p>要使用容器名操作容器，就先得给容器命名，在创建容器时，我们可以通过 --name 这个选项来配置容器名。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ <span class="token function">sudo</span> docker create --name nginx nginx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><strong>启动容器</strong>
通过 <strong>docker create</strong> 创建的容器，是处于 Created 状态的，其内部的应用程序还没有启动，所以我们需要通过 <strong>docker start</strong> 命令来启动它。</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> docker start nginx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>在 Docker 里，还允许我们通过 <strong>docker run</strong> 这个命令将 <strong>docker create</strong> 和 <strong>docker start</strong> 这两步操作合成为一步，进一步提高工作效率。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ <span class="token function">sudo</span> docker run --name nginx -d nginx:1.12
89f2b769498a50f5c35a314ab82300ce9945cbb69da9cda4b022646125db8ca7
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><strong>管理容器</strong>
通过 <strong>docker ps</strong> 这个命令，我们可以罗列出 Docker 中的容器。</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ <span class="token function">sudo</span> docker <span class="token function">ps</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>默认情况下，<strong>docker ps</strong> 列出的容器是处于运行中的容器，如果要列出所有状态的容器，需要增加 -a 或 --all 选项。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ <span class="token function">sudo</span> docker <span class="token function">ps</span> -a
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><strong>停止和删除容器</strong>
要将正在运行的容器停止，我们可以使用 <strong>docker stop</strong> 命令。</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ <span class="token function">sudo</span> docker stop nginx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>容器停止后，其维持的文件系统沙盒环境还是存在的，内部被修改的内容也都会保留，我们可以通过 <strong>docker start</strong> 命令将这个容器再次启动。</p> <p>当我们需要完全删除容器时，可以通过 <strong>docker rm</strong> 命令将容器进行删除。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ <span class="token function">sudo</span> docker <span class="token function">rm</span> nginx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>正在运行中的容器默认情况下是不能被删除的，我们可以通过增加 -f 或 --force 选项来让 <strong>docker rm</strong> 强制停止并删除容器，不过这种做法并不妥当。</p> <ul><li><strong>进入容器</strong></li></ul> <p>使用exec可以进入容器，进行操作</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> docker <span class="token builtin class-name">exec</span> -it 容器id /bin/bash
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>在容器中可能出现无sudo方法，并且使用apt-get、yum等安装缺需要root权限等，可以使用以下的命令进入管理者模式</p></div> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> docker <span class="token builtin class-name">exec</span> -it -u root 容器id /bin/bash
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><strong>可以用来试水的镜像</strong></li></ul> <p>在我们使用docker，可以先搞一些比较好玩的镜像来使用</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># docker 安装 portainer（ docker 容器的 GUI 管理方案</span>
<span class="token comment"># 下载镜像</span>
docker pull portainer/portainer

<span class="token comment"># 创建 volume</span>
docker volume create portainer_data
<span class="token comment"># 单机 portainer</span>
docker run -d -p <span class="token number">9000</span>:9000 -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data portainer/portainer
<span class="token comment"># 访问：http://xxx.xxx.xxx.xxx:9000</span>

<span class="token comment"># docker 安装 jenkins docker 自动化部署集成方案 下面在使用中会重点提到</span>
docker pull jenkins
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="jenkins使用"><a href="#jenkins使用" class="header-anchor">#</a> Jenkins使用</h2> <p>以上我们学习了前端的部署，node服务的部署，docker的基本使用，那么我们就可以开始我们的服务持续集成的最后一步，jenkins的使用</p> <h3 id="安装java8"><a href="#安装java8" class="header-anchor">#</a> 安装java8</h3> <ul><li>可以先查看可安装java版本。</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>yum -y list java**
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>因为我们的机器是64位的，所以选择安装java-1.8.0-openjdk-devel.x86_64，耐心等待至自动安装完成</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>yum <span class="token function">install</span> -y java-1.8.0-openjdk-devel.x86_64
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>查看安装的版本，检查是否安装成功</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>java -version
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>查看安装的路径</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>1rpm -ql java-1.8.0-openjdk

<span class="token comment"># 目录一般是 /usr/lib/jvm</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="安装镜像jenkins"><a href="#安装镜像jenkins" class="header-anchor">#</a> 安装镜像jenkins</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>因为官方jenkins镜像已经停止维护，一些插件无法安装，所以建议不要使用官方jenkins、使用中文版的jenkins/jenkins</p></div> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>docker pull jenkins/jenkins
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="启动jenkins容器"><a href="#启动jenkins容器" class="header-anchor">#</a> 启动jenkins容器</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 把jenkins/jenkins重新命名为reina-jenkins，并代理制8080端口启动</span>
docker run --name reina-jenkins -p <span class="token number">8000</span>:8080 -p <span class="token number">50000</span>:50000 jenkins/jenkins
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="查看容器的运行状态"><a href="#查看容器的运行状态" class="header-anchor">#</a> 查看容器的运行状态</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>docker <span class="token function">ps</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>因为我们使用的是8080端口，记得在服务器上配置好哦</p></div> <h3 id="jenkins的关闭-重新启动"><a href="#jenkins的关闭-重新启动" class="header-anchor">#</a> jenkins的关闭&amp;重新启动</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 关闭</span>
docker stop <span class="token punctuation">[</span>id/name<span class="token punctuation">]</span>

<span class="token comment"># 再次启动</span>
docker start <span class="token punctuation">[</span>id/name<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="初始化配置jenkins"><a href="#初始化配置jenkins" class="header-anchor">#</a> 初始化配置jenkins</h3> <p>第一次进入需要输入jenkins容器密码，那么这个密码是什么呢？我们一步一步来看</p> <ul><li><strong>打印容器中的信息，获取初始化登录密码</strong></li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>docker logs -f reina-jenkins
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><img src="/imgs/pwd.jpg" alt="mixureSecure"> <ul><li><p><strong>第一次进入需要进行安装和初始化，选择install</strong> <img src="/imgs/install.jpg" alt="mixureSecure"></p></li> <li><p><strong>接着会自动进行插件安装，因没有配置代理，安装失败可暂时忽略</strong> <img src="/imgs/start.jpg" alt="mixureSecure"></p></li> <li><p><strong>创建用户并登陆</strong>
输入相应信息</p></li> <li><p><strong>登陆成功后，配置Jenkins代理</strong>
路径：系统设置-&gt;插件管理-&gt;高级设置-&gt;升级站点</p></li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code># 替换为该站点并保存
https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><strong>安装插件</strong></li></ul> <p>系统管理 -&gt; 管理插件 -&gt; 可选插件，可参考初始登陆时推荐安装的插件进行选择。因为要配置Jenkins从GitHub自动拉取代码，因此必须安装Git和GitHub。</p> <ul><li><strong>github中token获取</strong></li></ul> <p>登陆GitHub，依次选择settings - developer settings - personal access tokens - generate new token，选择如下选项（repo和admin: repo_hook）后生成token（记得复制，每个token只能显示一次）</p> <ul><li><strong>github更新通知jenkins</strong></li></ul> <p>登录要自动部署的项目，Settings -&gt; Webhooks -&gt; 右上角Add webhook -&gt; Payload URL中输入jenkins地址(http://&lt;jenkins地址&gt;/github-webhook/) -&gt; 保存</p> <ul><li><strong>在Jenkins，创建构建任务</strong> <ul><li>自定义任务名称 输入任务名称。并选择构建一个自由风格的项目</li> <li>​创建完成后进入配置页面，选则GitHub项目，并输入Github的URL</li> <li>​源码管理中，选择Git，填入对应仓库URL</li> <li>​添加Credentials，选择类型为Secret Text，在Secret处填入github中生成的token</li> <li>指定需要构建的分支，默认为master(github目前新分支改为了main)，并选择构建触发时机，此处我勾选的是代码提交时自动触发</li> <li>为了测试配置是否成功，下面配置构建脚本，打印‘Hello World’</li></ul></li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>到这里我们已经完成了一大半了，github提交代码的时候 会自动触发jenkins的构建，可以试验一下</p></div> <h3 id="jenkins构建部署至服务器"><a href="#jenkins构建部署至服务器" class="header-anchor">#</a> jenkins构建部署至服务器</h3> <p>我们使用自定义linux命令的方式部署到服务器上</p> <ul><li><p><strong>安装插件</strong>
和上面安装插件的方式一样，安装Publish Over SSH</p></li> <li><p><strong>配置服务器地址</strong>
回到jenkins首页，系统管理 -&gt; 系统配置 -&gt; 找到Publish over SSH</p></li></ul> <p>配置参数</p> <table><thead><tr><th>参数</th> <th style="text-align:center;">含义</th></tr></thead> <tbody><tr><td>name</td> <td style="text-align:center;">选项的名字，随意起</td></tr> <tr><td>Hostname</td> <td style="text-align:center;">服务器的地址</td></tr> <tr><td>Username</td> <td style="text-align:center;">用户名，一般是root</td></tr> <tr><td>Remote Directory</td> <td style="text-align:center;">根目录，一般输入/</td></tr></tbody></table> <ul><li><strong>进行配置</strong></li> <li>进入到jenkins的项目配置中，找到构建环境，选择Send files or execute commands over SSH after the build runs</li> <li>Name选择刚才配置好的选项</li> <li>Source files 源文件名</li> <li>Remote directory 移动到服务器的目录</li> <li>Exec command 部署完之后的操作，可以直接写入linux指令</li> <li>保存应用</li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>至此，我们docker+jenkins+github的项目持续集成就可以了，可以push文件到github进行试验了。</p></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">12/11/2020, 4:16:12 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/project/" class="prev">
        项目应用
      </a></span> <span class="next"><a href="/algorithm/">
        前端算法
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.bebcfdff.js" defer></script><script src="/assets/js/2.3a20e52e.js" defer></script><script src="/assets/js/13.98915912.js" defer></script>
  </body>
</html>
